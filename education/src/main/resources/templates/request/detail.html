<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Board</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/fixed/header2.css" />
    <link rel="stylesheet" href="/css/fixed/footer.css" />
    <link rel="stylesheet" href="/css/request/reset.css" />
    <link rel="stylesheet" href="/css/request/detail.css" />
</head>
<body>
<header th:replace="/fixed/header2.html :: body"></header>
        <main>
            <!-- Í≤åÏãúÍ∏Ä -->
            <section class="post_area">
                <!-- ÏÇ¨Ïù¥Îìú -->
                <div class="post_side_area">
                    <!-- Îí§Î°ú Í∞ÄÍ∏∞ -->
                    <div class="side_left_area">
                        <a class="back_button">
                            <div class="back_img"></div>
                        </a>
                    </div>
                    <!-- Í∞ÄÏö¥Îç∞ ÎπÑÏõåÎëêÍ∏∞ -->
                    <div class="side_middle_area"></div>
                    <!-- Ï¢ãÏïÑÏöî -->
                    <div class="side_right_area">
                        <div class="like_box">
                            <button class="like_button">
                                <div class="heart_img"></div>
                                <div class="like_count" th:text="${countHeart}"></div>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Ïª®ÌÖêÏ∏† -->
                <div class="post_content_area">
                    <div class="post_container">
                        <div class="post_header" th:object="${request}">
                            <div class="post_title" th:text="*{requestTitle}"></div>
                            <div class="post_info">
                                <span class="post_writer" th:text="*{userNickname}">myewon</span>
                                <span class="post_dot">¬∑</span>
                                <span class="post_date" th:text="*{#strings.substring(requestRegisterDate,0,10)}">2022.11.18</span>
                            </div>
                        </div>
                        <div class="post_body">
                            <div class="post_content">
                                <div class="content_text" th:text="${request.requestContent}">

                                </div>
                            </div>
                            <div class="post_category">
                                <a class="category_box" href="">
                                    <p class="category_text" th:text="${request.requestCategory}">Í∞úÎ∞ú¬∑ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç</p>
                                    <p class="move_to_lecture">
                                        Î™®ÏßëÏ§ëÏù∏ Í∞ïÏùò
                                        Î≥¥Îü¨Í∞ÄÍ∏∞&nbsp;&nbsp;&nbsp;>
                                    </p>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- ÎåìÍ∏Ä Îã¨Í∏∞ -->
            <div class="comment">
                <section class="write_reply_area">
                    <div class="write_reply_container">
                        <!-- ÎåìÍ∏Ä Ìó§Îçî -->
                        <div class="write_reply_header">
                            <span>üòÄ</span>
                            <span class="writer">myewon</span>
                            <span>Îãò, ÎãµÍ∏ÄÏùÑ ÎÇ®Í≤®Î≥¥ÏÑ∏Ïöî!</span>
                        </div>
                        <!-- ÎåìÍ∏Ä ÏûëÏÑ± Ïπ∏ -->
                        <div class="write_reply_box">
                            <form th:action="@{/comment/new}">
                                <textarea name="requestCommentContent" cols="30" rows="5"></textarea>
                            </form>
                        </div>
                        <!-- ÎåìÍ∏Ä Î≤ÑÌäº -->
                        <div class="reply_write_button_area">
                            <div class="reply_write_button_space">
                                <a class="register-button-wrapper">
                                <button type="submit" class="reply_write_button">
                                    ÎãµÎ≥Ä Îì±Î°ù
                                </button>
                                </a>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- ÎåìÍ∏ÄÎ™©Î°ù -->
                <section class="reply_area">
                    <div class="reply_count_area">
                        <div class="reply_count_container">
                            <span>Ï¥ù</span>
                            <span class="repky_count" th:text="${#lists.size(requestComments)}"></span>
                            <span>Í∞úÏùò ÎåìÍ∏ÄÏù¥ Îã¨Î†∏ÏäµÎãàÎã§.</span>
                        </div>
                    </div>

<!--                    ÎåìÍ∏Ä ÏãúÏûë -->
                    <!-- Ï≤´Î≤àÏß∏ ÎåìÍ∏Ä -->

                    <div class="request-comment-wrapper">
                        <div class="reply_read_container" >
                            <!-- ÎåìÍ∏Ä Ìó§Îçî -->
                            <div class="reply_read_header">
                                <div class="reply_writer" >Î´ºÎπÑÏö∞Ïä§</div>
                                <div class="reply_date">2022.11.18</div>
                                <div class="reply_button_area">
                                    <button class="modify_button">ÏàòÏ†ï</button>
                                    <button class="remove_button">ÏÇ≠Ï†ú</button>
                                </div>
                            </div>
                            <!-- ÎåìÍ∏Ä ÎÇ¥Ïö© -->
                            <div class="reply_content">

                            </div>
                        </div>
                    </div>



                </section>
            </div>
        </main>
        <footer th:replace="/fixed/footer.html :: #footer"></footer>
    </body>
    <script src="/js/request/detail.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script th:inline="javascript">
        HTMLCollection.prototype.forEach = Array.prototype.forEach;
        let requestNumber = [[${request.requestNumber}]];
        let userNumber = [[${session.userNumber}]];

        console.log(requestNumber);

        // requestCommentService.add({
        //     requestCommentContent : "test",
        //     userNumber : 0,
        //     requestNumber : requestNumber
        // },showAlert,function (a,b,c) {
        //     console.log((a,b,c));
        // });
        //
        // function showAlert(result){
        //     alert(result);
        // }


        // Ï†ÑÏ≤¥ Î™©Î°ù Ï°∞Ìöå
        // requestCommentService.getList(requestNumber,showList);
        //
        // function showList(requestComments) {
        //     console.log(requestComments);
        // }

        // select one
        // requestCommentService.read(22,showRequestComment)
        //
        // function showRequestComment(requestComment) {
        //     console.log(requestComment);
        // }

    //    delete
    //     requestCommentService.remove(22,showResult)
    //
    //     function showResult(requestComment) {
    //         console.log(requestComment);
    //     }

    //    modify
    //     requestCommentService.modify({
    //         requestCommentNumber:25,
    //         requestCommentContent:"modify ÏàòÏû•Îê®"
    //     });

        getList();


        //ÎåìÍ∏Ä ÏûÖÎ†•
        $("a.register-button-wrapper").on("click",function () {
            let requestCommentContent = $("textarea[name='requestCommentContent']").val();
            requestCommentService.add({
                requestCommentContent : requestCommentContent,
                userNumber : userNumber,
                requestNumber : requestNumber
            },function () {
                window.location.reload();
            })
            getList();
        });

        // Î™©Î°ù Î≥¥Ïó¨ÏßÄÎäî Î∂ÄÎ∂Ñ
        function getList() {
            requestCommentService.getList(requestNumber,showList);
        }

        function showList(requestComments) {
            let text="";
            requestComments.forEach(requestComment =>{
                text += "<div class='reply_read_container' >";
                text += "<div class='reply_read_header'>";
                text += "<div class='reply_writer'>" +requestComment.userNickname + "</div>";
                text += "<div class='reply_date'>"+ requestComment.requestCommentModifyDate+"</div>";
                text += "<div class='reply_button_area'>";
                text += "<button class='modify_button first-show' style='cursor: pointer;'>ÏàòÏ†ï</button>";
                text += "<button class='remove_button first-show' style='cursor: pointer;'>ÏÇ≠Ï†ú</button>";
                text += "<button class='modify-save second-show' style='cursor: pointer;'>ÏàòÏ†ï ÏôÑÎ£å</button>";
                text += "<button class='modify-cancel second-show' style='cursor: pointer;'>Ï∑®ÏÜå</button>";
                text += "</div>";
                text += "</div>";
                text += "<div class='reply_content'>";
                text += requestComment.requestCommentContent;
                text+="</div>";
                text+="</div>";
            });
            $("div.request-comment-wrapper").html(text);
            $("button.second-show").hide();
        }
    //    ÎåìÍ∏Ä ÏàòÏ†ï

        $("div.request-comment-wrapper").on("click", "button.modify_button", function(){
            console.log($(this));
            $(this).hide();
            $(this).next().hide();
            $(this).next().next().show();
            $(this).next().next().next().show();


        })







    </script>
</html>
